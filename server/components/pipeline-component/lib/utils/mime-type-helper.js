'use strict'

function MimeTypeHelper() { }

MimeTypeHelper.prototype.determineMimeType = function (fileName) {

    const mimeTypes = [{ 'extension': '3g2', 'mimeType': 'video/3gpp2' },
    { 'extension': '3gp', 'mimeType': 'video/3gpp' },
    { 'extension': '3gp2', 'mimeType': 'video/3gpp2' },
    { 'extension': '3gpp', 'mimeType': 'video/3gpp' },
    { 'extension': 'aa', 'mimeType': 'audio/audible' },
    { 'extension': 'aac', 'mimeType': 'audio/vnd.dlna.adts' },
    { 'extension': 'aax', 'mimeType': 'audio/vnd.audible.aax' },
    { 'extension': 'addin', 'mimeType': 'text/xml' },
    { 'extension': 'adt', 'mimeType': 'audio/vnd.dlna.adts' },
    { 'extension': 'adts', 'mimeType': 'audio/vnd.dlna.adts' },
    { 'extension': 'ai', 'mimeType': 'application/postscript' },
    { 'extension': 'aif', 'mimeType': 'audio/aiff' },
    { 'extension': 'aifc', 'mimeType': 'audio/aiff' },
    { 'extension': 'aiff', 'mimeType': 'audio/aiff' },
    { 'extension': 'application', 'mimeType': 'application/x-ms-application' },
    { 'extension': 'asax', 'mimeType': 'application/xml' },
    { 'extension': 'ascx', 'mimeType': 'application/xml' },
    { 'extension': 'asf', 'mimeType': 'video/x-ms-asf' },
    { 'extension': 'ashx', 'mimeType': 'application/xml' },
    { 'extension': 'asmx', 'mimeType': 'application/xml' },
    { 'extension': 'aspx', 'mimeType': 'application/xml' },
    { 'extension': 'asx', 'mimeType': 'video/x-ms-asf' },
    { 'extension': 'au', 'mimeType': 'audio/basic' },
    { 'extension': 'avi', 'mimeType': 'video/avi' },
    { 'extension': 'bmp', 'mimeType': 'image/bmp' },
    { 'extension': 'btapp', 'mimeType': 'application/x-bittorrent-app' },
    { 'extension': 'btinstall', 'mimeType': 'application/x-bittorrent-appinst' },
    { 'extension': 'btkey', 'mimeType': 'application/x-bittorrent-key' },
    { 'extension': 'btsearch', 'mimeType': 'application/x-bittorrentsearchdescription+xml' },
    { 'extension': 'btskin', 'mimeType': 'application/x-bittorrent-skin' },
    { 'extension': 'cat', 'mimeType': 'application/vnd.ms-pki.seccat' },
    { 'extension': 'cd', 'mimeType': 'text/plain' },
    { 'extension': 'cer', 'mimeType': 'application/x-x509-ca-cert' },
    { 'extension': 'config', 'mimeType': 'application/xml' },
    { 'extension': 'contact', 'mimeType': 'text/x-ms-contact' },
    { 'extension': 'crl', 'mimeType': 'application/pkix-crl' },
    { 'extension': 'crt', 'mimeType': 'application/x-x509-ca-cert' },
    { 'extension': 'cs', 'mimeType': 'text/plain' },
    { 'extension': 'csproj', 'mimeType': 'text/plain' },
    { 'extension': 'css', 'mimeType': 'text/css' },
    { 'extension': 'csv', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'datasource', 'mimeType': 'application/xml' },
    { 'extension': 'der', 'mimeType': 'application/x-x509-ca-cert' },
    { 'extension': 'dib', 'mimeType': 'image/bmp' },
    { 'extension': 'dll', 'mimeType': 'application/x-msdownload' },
    { 'extension': 'doc', 'mimeType': 'application/msword' },
    { 'extension': 'docm', 'mimeType': 'application/vnd.ms-word.document.macroEnabled.12' },
    { 'extension': 'docx', 'mimeType': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' },
    { 'extension': 'dot', 'mimeType': 'application/msword' },
    { 'extension': 'dotm', 'mimeType': 'application/vnd.ms-word.template.macroEnabled.12' },
    { 'extension': 'dotx', 'mimeType': 'application/vnd.openxmlformats-officedocument.wordprocessingml.template' },
    { 'extension': 'dtd', 'mimeType': 'application/xml-dtd' },
    { 'extension': 'dtsconfig', 'mimeType': 'text/xml' },
    { 'extension': 'eps', 'mimeType': 'application/postscript' },
    { 'extension': 'exe', 'mimeType': 'application/x-msdownload' },
    { 'extension': 'fdf', 'mimeType': 'application/vnd.fdf' },
    { 'extension': 'fif', 'mimeType': 'application/fractals' },
    { 'extension': 'gif', 'mimeType': 'image/gif' },
    { 'extension': 'group', 'mimeType': 'text/x-ms-group' },
    { 'extension': 'hdd', 'mimeType': 'application/x-virtualbox-hdd' },
    { 'extension': 'hqx', 'mimeType': 'application/mac-binhex40' },
    { 'extension': 'hta', 'mimeType': 'application/hta' },
    { 'extension': 'htc', 'mimeType': 'text/x-component' },
    { 'extension': 'htm', 'mimeType': 'text/html' },
    { 'extension': 'html', 'mimeType': 'text/html' },
    { 'extension': 'hxa', 'mimeType': 'application/xml' },
    { 'extension': 'hxc', 'mimeType': 'application/xml' },
    { 'extension': 'hxd', 'mimeType': 'application/octet-stream' },
    { 'extension': 'hxe', 'mimeType': 'application/xml' },
    { 'extension': 'hxf', 'mimeType': 'application/xml' },
    { 'extension': 'hxh', 'mimeType': 'application/octet-stream' },
    { 'extension': 'hxi', 'mimeType': 'application/octet-stream' },
    { 'extension': 'hxk', 'mimeType': 'application/xml' },
    { 'extension': 'hxq', 'mimeType': 'application/octet-stream' },
    { 'extension': 'hxr', 'mimeType': 'application/octet-stream' },
    { 'extension': 'hxs', 'mimeType': 'application/octet-stream' },
    { 'extension': 'hxt', 'mimeType': 'application/xml' },
    { 'extension': 'hxv', 'mimeType': 'application/xml' },
    { 'extension': 'hxw', 'mimeType': 'application/octet-stream' },
    { 'extension': 'ico', 'mimeType': 'image/x-icon' },
    { 'extension': 'ics', 'mimeType': 'text/calendar' },
    { 'extension': 'ipa', 'mimeType': 'application/x-itunes-ipa' },
    { 'extension': 'ipg', 'mimeType': 'application/x-itunes-ipg' },
    { 'extension': 'ipsw', 'mimeType': 'application/x-itunes-ipsw' },
    { 'extension': 'iqy', 'mimeType': 'text/x-ms-iqy' },
    { 'extension': 'iss', 'mimeType': 'text/plain' },
    { 'extension': 'ite', 'mimeType': 'application/x-itunes-ite' },
    { 'extension': 'itlp', 'mimeType': 'application/x-itunes-itlp' },
    { 'extension': 'itls', 'mimeType': 'application/x-itunes-itls' },
    { 'extension': 'itms', 'mimeType': 'application/x-itunes-itms' },
    { 'extension': 'itpc', 'mimeType': 'application/x-itunes-itpc' },
    { 'extension': 'jfif', 'mimeType': 'image/jpeg' },
    { 'extension': 'jnlp', 'mimeType': 'application/x-java-jnlp-file' },
    { 'extension': 'jpe', 'mimeType': 'image/jpeg' },
    { 'extension': 'jpeg', 'mimeType': 'image/jpeg' },
    { 'extension': 'jpg', 'mimeType': 'image/jpeg' },
    { 'extension': 'js', 'mimeType': 'application/javascript' },
    { 'extension': 'latex', 'mimeType': 'application/x-latex' },
    { 'extension': 'library-ms', 'mimeType': 'application/windows-library+xml' },
    { 'extension': 'm1v', 'mimeType': 'video/mpeg' },
    { 'extension': 'm2t', 'mimeType': 'video/vnd.dlna.mpeg-tts' },
    { 'extension': 'm2ts', 'mimeType': 'video/vnd.dlna.mpeg-tts' },
    { 'extension': 'm2v', 'mimeType': 'video/mpeg' },
    { 'extension': 'm3u', 'mimeType': 'audio/mpegurl' },
    { 'extension': 'm3u8', 'mimeType': 'audio/x-mpegurl' },
    { 'extension': 'm4a', 'mimeType': 'audio/m4a' },
    { 'extension': 'm4b', 'mimeType': 'audio/m4b' },
    { 'extension': 'm4p', 'mimeType': 'audio/m4p' },
    { 'extension': 'm4r', 'mimeType': 'audio/x-m4r' },
    { 'extension': 'm4v', 'mimeType': 'video/x-m4v' },
    { 'extension': 'magnet', 'mimeType': 'application/x-magnet' },
    { 'extension': 'man', 'mimeType': 'application/x-troff-man' },
    { 'extension': 'master', 'mimeType': 'application/xml' },
    { 'extension': 'mht', 'mimeType': 'message/rfc822' },
    { 'extension': 'mhtml', 'mimeType': 'message/rfc822' },
    { 'extension': 'mid', 'mimeType': 'audio/mid' },
    { 'extension': 'midi', 'mimeType': 'audio/mid' },
    { 'extension': 'mod', 'mimeType': 'video/mpeg' },
    { 'extension': 'mov', 'mimeType': 'video/quicktime' },
    { 'extension': 'mp2', 'mimeType': 'audio/mpeg' },
    { 'extension': 'mp2v', 'mimeType': 'video/mpeg' },
    { 'extension': 'mp3', 'mimeType': 'audio/mpeg' },
    { 'extension': 'mp4', 'mimeType': 'video/mp4' },
    { 'extension': 'mp4v', 'mimeType': 'video/mp4' },
    { 'extension': 'mpa', 'mimeType': 'video/mpeg' },
    { 'extension': 'mpe', 'mimeType': 'video/mpeg' },
    { 'extension': 'mpeg', 'mimeType': 'video/mpeg' },
    { 'extension': 'mpf', 'mimeType': 'application/vnd.ms-mediapackage' },
    { 'extension': 'mpg', 'mimeType': 'video/mpeg' },
    { 'extension': 'mpv2', 'mimeType': 'video/mpeg' },
    { 'extension': 'mts', 'mimeType': 'video/vnd.dlna.mpeg-tts' },
    { 'extension': 'odc', 'mimeType': 'text/x-ms-odc' },
    { 'extension': 'odg', 'mimeType': 'application/vnd.oasis.opendocument.graphics' },
    { 'extension': 'odm', 'mimeType': 'application/vnd.oasis.opendocument.text-master' },
    { 'extension': 'odp', 'mimeType': 'application/vnd.oasis.opendocument.presentation' },
    { 'extension': 'ods', 'mimeType': 'application/vnd.oasis.opendocument.spreadsheet' },
    { 'extension': 'odt', 'mimeType': 'application/vnd.oasis.opendocument.text' },
    { 'extension': 'ogg', 'mimeType': 'audio/ogg' },
    { 'extension': 'otg', 'mimeType': 'application/vnd.oasis.opendocument.graphics-template' },
    { 'extension': 'oth', 'mimeType': 'application/vnd.oasis.opendocument.text-web' },
    { 'extension': 'ots', 'mimeType': 'application/vnd.oasis.opendocument.spreadsheet-template' },
    { 'extension': 'ott', 'mimeType': 'application/vnd.oasis.opendocument.text-template' },
    { 'extension': 'ova', 'mimeType': 'application/x-virtualbox-ova' },
    { 'extension': 'ovf', 'mimeType': 'application/x-virtualbox-ovf' },
    { 'extension': 'oxt', 'mimeType': 'application/vnd.openofficeorg.extension' },
    { 'extension': 'p10', 'mimeType': 'application/pkcs10' },
    { 'extension': 'p12', 'mimeType': 'application/x-pkcs12' },
    { 'extension': 'p7b', 'mimeType': 'application/x-pkcs7-certificates' },
    { 'extension': 'p7c', 'mimeType': 'application/pkcs7-mime' },
    { 'extension': 'p7m', 'mimeType': 'application/pkcs7-mime' },
    { 'extension': 'p7r', 'mimeType': 'application/x-pkcs7-certreqresp' },
    { 'extension': 'p7s', 'mimeType': 'application/pkcs7-signature' },
    { 'extension': 'pcast', 'mimeType': 'application/x-podcast' },
    { 'extension': 'pdf', 'mimeType': 'application/pdf' },
    { 'extension': 'pdfxml', 'mimeType': 'application/vnd.adobe.pdfxml' },
    { 'extension': 'pdx', 'mimeType': 'application/vnd.adobe.pdx' },
    { 'extension': 'pfx', 'mimeType': 'application/x-pkcs12' },
    { 'extension': 'pko', 'mimeType': 'application/vnd.ms-pki.pko' },
    { 'extension': 'pls', 'mimeType': 'audio/scpls' },
    { 'extension': 'png', 'mimeType': 'image/png' },
    { 'extension': 'pot', 'mimeType': 'application/vnd.ms-powerpoint' },
    { 'extension': 'potm', 'mimeType': 'application/vnd.ms-powerpoint.template.macroEnabled.12' },
    { 'extension': 'potx', 'mimeType': 'application/vnd.openxmlformats-officedocument.presentationml.template' },
    { 'extension': 'ppa', 'mimeType': 'application/vnd.ms-powerpoint' },
    { 'extension': 'ppam', 'mimeType': 'application/vnd.ms-powerpoint.addin.macroEnabled.12' },
    { 'extension': 'pps', 'mimeType': 'application/vnd.ms-powerpoint' },
    { 'extension': 'ppsm', 'mimeType': 'application/vnd.ms-powerpoint.slideshow.macroEnabled.12' },
    { 'extension': 'ppsx', 'mimeType': 'application/vnd.openxmlformats-officedocument.presentationml.slideshow' },
    { 'extension': 'ppt', 'mimeType': 'application/vnd.ms-powerpoint' },
    { 'extension': 'pptm', 'mimeType': 'application/vnd.ms-powerpoint.presentation.macroEnabled.12' },
    { 'extension': 'pptx', 'mimeType': 'application/vnd.openxmlformats-officedocument.presentationml.presentation' },
    { 'extension': 'prf', 'mimeType': 'application/pics-rules' },
    { 'extension': 'ps', 'mimeType': 'application/postscript' },
    { 'extension': 'psc1', 'mimeType': 'application/PowerShell' },
    { 'extension': 'pwz', 'mimeType': 'application/vnd.ms-powerpoint' },
    { 'extension': 'py', 'mimeType': 'text/plain' },
    { 'extension': 'pyw', 'mimeType': 'text/plain' },
    { 'extension': 'rat', 'mimeType': 'application/rat-file' },
    { 'extension': 'rc', 'mimeType': 'text/plain' },
    { 'extension': 'rc2', 'mimeType': 'text/plain' },
    { 'extension': 'rct', 'mimeType': 'text/plain' },
    { 'extension': 'rdlc', 'mimeType': 'application/xml' },
    { 'extension': 'resx', 'mimeType': 'application/xml' },
    { 'extension': 'rmi', 'mimeType': 'audio/mid' },
    { 'extension': 'rmp', 'mimeType': 'application/vnd.rn-rn_music_package' },
    { 'extension': 'rqy', 'mimeType': 'text/x-ms-rqy' },
    { 'extension': 'rtf', 'mimeType': 'application/msword' },
    { 'extension': 'sct', 'mimeType': 'text/scriptlet' },
    { 'extension': 'settings', 'mimeType': 'application/xml' },
    { 'extension': 'shtml', 'mimeType': 'text/html' },
    { 'extension': 'sit', 'mimeType': 'application/x-stuffit' },
    { 'extension': 'sitemap', 'mimeType': 'application/xml' },
    { 'extension': 'skin', 'mimeType': 'application/xml' },
    { 'extension': 'sldm', 'mimeType': 'application/vnd.ms-powerpoint.slide.macroEnabled.12' },
    { 'extension': 'sldx', 'mimeType': 'application/vnd.openxmlformats-officedocument.presentationml.slide' },
    { 'extension': 'slk', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'sln', 'mimeType': 'text/plain' },
    { 'extension': 'slupkg-ms', 'mimeType': 'application/x-ms-license' },
    { 'extension': 'snd', 'mimeType': 'audio/basic' },
    { 'extension': 'snippet', 'mimeType': 'application/xml' },
    { 'extension': 'spc', 'mimeType': 'application/x-pkcs7-certificates' },
    { 'extension': 'sst', 'mimeType': 'application/vnd.ms-pki.certstore' },
    { 'extension': 'stc', 'mimeType': 'application/vnd.sun.xml.calc.template' },
    { 'extension': 'std', 'mimeType': 'application/vnd.sun.xml.draw.template' },
    { 'extension': 'stl', 'mimeType': 'application/vnd.ms-pki.stl' },
    { 'extension': 'stw', 'mimeType': 'application/vnd.sun.xml.writer.template' },
    { 'extension': 'svg', 'mimeType': 'image/svg+xml' },
    { 'extension': 'sxc', 'mimeType': 'application/vnd.sun.xml.calc' },
    { 'extension': 'sxd', 'mimeType': 'application/vnd.sun.xml.draw' },
    { 'extension': 'sxg', 'mimeType': 'application/vnd.sun.xml.writer.global' },
    { 'extension': 'sxw', 'mimeType': 'application/vnd.sun.xml.writer' },
    { 'extension': 'tga', 'mimeType': 'image/targa' },
    { 'extension': 'thmx', 'mimeType': 'application/vnd.ms-officetheme' },
    { 'extension': 'tif', 'mimeType': 'image/tiff' },
    { 'extension': 'tiff', 'mimeType': 'image/tiff' },
    { 'extension': 'torrent', 'mimeType': 'application/x-bittorrent' },
    { 'extension': 'ts', 'mimeType': 'video/vnd.dlna.mpeg-tts' },
    { 'extension': 'tts', 'mimeType': 'video/vnd.dlna.mpeg-tts' },
    { 'extension': 'txt', 'mimeType': 'text/plain' },
    { 'extension': 'user', 'mimeType': 'text/plain' },
    { 'extension': 'vb', 'mimeType': 'text/plain' },
    { 'extension': 'vbox', 'mimeType': 'application/x-virtualbox-vbox' },
    { 'extension': 'vbox-extpack', 'mimeType': 'application/x-virtualbox-vbox-extpack' },
    { 'extension': 'vbproj', 'mimeType': 'text/plain' },
    { 'extension': 'vcf', 'mimeType': 'text/x-vcard' },
    { 'extension': 'vdi', 'mimeType': 'application/x-virtualbox-vdi' },
    { 'extension': 'vdp', 'mimeType': 'text/plain' },
    { 'extension': 'vdproj', 'mimeType': 'text/plain' },
    { 'extension': 'vhd', 'mimeType': 'application/x-virtualbox-vhd' },
    { 'extension': 'vmdk', 'mimeType': 'application/x-virtualbox-vmdk' },
    { 'extension': 'vor', 'mimeType': 'application/vnd.stardivision.writer' },
    { 'extension': 'vscontent', 'mimeType': 'application/xml' },
    { 'extension': 'vsi', 'mimeType': 'application/ms-vsi' },
    { 'extension': 'vspolicy', 'mimeType': 'application/xml' },
    { 'extension': 'vspolicydef', 'mimeType': 'application/xml' },
    { 'extension': 'vspscc', 'mimeType': 'text/plain' },
    { 'extension': 'vsscc', 'mimeType': 'text/plain' },
    { 'extension': 'vssettings', 'mimeType': 'text/xml' },
    { 'extension': 'vssscc', 'mimeType': 'text/plain' },
    { 'extension': 'vstemplate', 'mimeType': 'text/xml' },
    { 'extension': 'vsto', 'mimeType': 'application/x-ms-vsto' },
    { 'extension': 'wal', 'mimeType': 'interface/x-winamp3-skin' },
    { 'extension': 'wav', 'mimeType': 'audio/wav' },
    { 'extension': 'wave', 'mimeType': 'audio/wav' },
    { 'extension': 'wax', 'mimeType': 'audio/x-ms-wax' },
    { 'extension': 'wbk', 'mimeType': 'application/msword' },
    { 'extension': 'wdp', 'mimeType': 'image/vnd.ms-photo' },
    { 'extension': 'webm', 'mimeType': 'video/webm' },
    { 'extension': 'website', 'mimeType': 'application/x-mswebsite' },
    { 'extension': 'wiz', 'mimeType': 'application/msword' },
    { 'extension': 'wlz', 'mimeType': 'interface/x-winamp-lang' },
    { 'extension': 'wm', 'mimeType': 'video/x-ms-wm' },
    { 'extension': 'wma', 'mimeType': 'audio/x-ms-wma' },
    { 'extension': 'wmd', 'mimeType': 'application/x-ms-wmd' },
    { 'extension': 'wmv', 'mimeType': 'video/x-ms-wmv' },
    { 'extension': 'wmx', 'mimeType': 'video/x-ms-wmx' },
    { 'extension': 'wmz', 'mimeType': 'application/x-ms-wmz' },
    { 'extension': 'wpl', 'mimeType': 'application/vnd.ms-wpl' },
    { 'extension': 'wsc', 'mimeType': 'text/scriptlet' },
    { 'extension': 'wsdl', 'mimeType': 'application/xml' },
    { 'extension': 'wsz', 'mimeType': 'interface/x-winamp-skin' },
    { 'extension': 'wvx', 'mimeType': 'video/x-ms-wvx' },
    { 'extension': 'xaml', 'mimeType': 'application/xaml+xml' },
    { 'extension': 'xbap', 'mimeType': 'application/x-ms-xbap' },
    { 'extension': 'xdp', 'mimeType': 'application/vnd.adobe.xdp+xml' },
    { 'extension': 'xdr', 'mimeType': 'application/xml' },
    { 'extension': 'xfdf', 'mimeType': 'application/vnd.adobe.xfdf' },
    { 'extension': 'xht', 'mimeType': 'application/xhtml+xml' },
    { 'extension': 'xhtml', 'mimeType': 'application/xhtml+xml' },
    { 'extension': 'xla', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xlam', 'mimeType': 'application/vnd.ms-excel.addin.macroEnabled.12' },
    { 'extension': 'xld', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xlk', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xll', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xlm', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xls', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xlsb', 'mimeType': 'application/vnd.ms-excel.sheet.binary.macroEnabled.12' },
    { 'extension': 'xlsm', 'mimeType': 'application/vnd.ms-excel.sheet.macroEnabled.12' },
    { 'extension': 'xlsx', 'mimeType': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' },
    { 'extension': 'xlt', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xltm', 'mimeType': 'application/vnd.ms-excel.template.macroEnabled.12' },
    { 'extension': 'xltx', 'mimeType': 'application/vnd.openxmlformats-officedocument.spreadsheetml.template' },
    { 'extension': 'xlw', 'mimeType': 'application/vnd.ms-excel' },
    { 'extension': 'xml', 'mimeType': 'text/xml' },
    { 'extension': 'xrm-ms', 'mimeType': 'text/xml' },
    { 'extension': 'xsc', 'mimeType': 'application/xml' },
    { 'extension': 'xsd', 'mimeType': 'application/xml' },
    { 'extension': 'xsl', 'mimeType': 'text/xml' },
    { 'extension': 'xslt', 'mimeType': 'application/xml' },
    { 'extension': 'xss', 'mimeType': 'application/xml' }]

    let ext = fileName.substring(fileName.lastIndexOf('.') + 1)
    let matched = mimeTypes.filter((mimeType, idx) => {
        return (mimeType.extension === ext)
    })
    if (matched.length === 0) {
        return 'binary/octet-stream'
    }
    return matched[0].mimeType
}

module.exports = new MimeTypeHelper()